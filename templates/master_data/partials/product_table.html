{% load humanize %}

<!-- Product Grid (Rich Card Design) -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    {% for product in products %}
    <div
        class="group relative bg-white rounded-3xl p-6 border border-gray-100 hover:border-orange-200 hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 flex flex-col h-full">

        <!-- Action Buttons (Absolute Top-Right, visible on hover) -->
        <div
            class="absolute top-6 right-6 flex gap-2 opacity-0 group-hover:opacity-100 transition-all duration-300 z-10">
            <a href="{% url 'product_edit' product.pk %}"
                class="p-2 rounded-xl bg-white border border-gray-100 text-gray-400 hover:text-blue-600 hover:border-blue-100 shadow-sm transition-colors"
                title="Edit">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
            </a>
            <a href="{% url 'product_delete' product.pk %}"
                class="p-2 rounded-xl bg-white border border-gray-100 text-gray-400 hover:text-red-600 hover:border-red-100 shadow-sm transition-colors"
                title="Delete">
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
            </a>
        </div>

        <!-- Header: Icon & Category -->
        <div class="flex items-start justify-between mb-4">
            <div class="flex gap-4">
                <!-- Visual Anchor (Icon Box) -->
                <div
                    class="w-12 h-12 rounded-2xl bg-orange-50 text-orange-600 flex items-center justify-center shrink-0">
                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                </div>

                <!-- Category Badge -->
                <div>
                    <span
                        class="inline-block bg-gray-100 text-gray-600 text-[10px] font-bold uppercase tracking-wider px-2 py-1 rounded mb-1">
                        {{ product.category.name|default:"General" }}
                    </span>
                </div>
            </div>
        </div>

        <!-- Body: Title & Manufacturer -->
        <div class="mb-6">
            <h3
                class="text-lg font-bold text-gray-900 leading-tight mb-1 group-hover:text-orange-600 transition-colors">
                {{ product.name }}
            </h3>
            <p class="text-sm font-medium text-gray-500">
                {{ product.manufacturer.name|default:"Unknown Manufacturer" }}
            </p>
        </div>

        <!-- Footer: Meta Grid (Gray Box) -->
        <div class="mt-auto bg-gray-50/50 rounded-xl p-3 border border-gray-100 flex items-center justify-between">
            <div class="flex flex-col">
                <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">Unit Type</span>
                <span class="text-sm font-bold text-gray-700">{{ product.unit_type }}</span>
            </div>
            <div class="w-px h-8 bg-gray-200"></div>
            <div class="flex flex-col text-right">
                <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">HSN Code</span>
                <span class="text-sm font-bold text-gray-700 font-mono">{{ product.hsn_code|default:"-" }}</span>
            </div>
        </div>

    </div>
    {% empty %}
    <div class="col-span-full py-20 text-center bg-gray-50 rounded-3xl border-2 border-dashed border-gray-200">
        <div class="w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-2xl flex items-center justify-center">
            <svg class="w-8 h-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
            </svg>
        </div>
        <h3 class="text-lg font-medium text-gray-900">No products found</h3>
        <p class="text-gray-500 mt-1">Try adjusting your search</p>
    </div>
    {% endfor %}
</div>

<!-- Pagination -->
{% if is_paginated %}
<div class="flex items-center justify-center gap-6 pt-8 pb-4">
    <a href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% else %}#{% endif %}"
        class="group p-4 rounded-2xl bg-white border border-gray-100 text-gray-400 hover:text-gray-900 hover:border-gray-300 hover:shadow-lg hover:shadow-gray-200/50 {% if not page_obj.has_previous %}opacity-30 pointer-events-none{% endif %} transition-all duration-300">
        <svg class="w-5 h-5 group-hover:-translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
    </a>
    <div class="flex flex-col items-center gap-1">
        <span class="text-sm font-bold text-gray-900">Page {{ page_obj.number }}</span>
        <span class="text-[10px] font-bold text-gray-400 uppercase tracking-widest">of {{
            page_obj.paginator.num_pages }}</span>
    </div>
    <a href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% else %}#{% endif %}"
        class="group p-4 rounded-2xl bg-white border border-gray-100 text-gray-400 hover:text-gray-900 hover:border-gray-300 hover:shadow-lg hover:shadow-gray-200/50 {% if not page_obj.has_next %}opacity-30 pointer-events-none{% endif %} transition-all duration-300">
        <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24"
            stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
    </a>
</div>
{% endif %}